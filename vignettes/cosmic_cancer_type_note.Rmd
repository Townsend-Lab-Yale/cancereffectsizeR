---
title: "Cancer type considerations for COSMIC signature extraction"
---
The cancereffectsizeR `trinuc_mutation_rates()` function uses mutational signature extraction to calculate relative trinucleotide-specific SNV mutation rates in tumors. The "signatures_to_remove" option allows some signatures to be excluded from this analysis, which means each tumor will receive a weight of 0 for these signatures, indicating that none of the tumor's SNVs are attributable to these signatures.

In [Alexandrov 2020](https://doi.org/10.1038/s41586-020-1943-3), the paper introducing the latest COSMIC mutational signatures (COSMICv3),
there are some signatures that do not appear in certain cancer types. Consider excluding some or all of these signatures in `trinuc_mutation_rates()`.

There are also a few signatures associated with cancer treatment (SBS11, SBS31, SBS32, SBS35, SBS86, SBS87, SBS90), so if you are confident that your sample 
is treatment-naive, or at least hasn't been exposed to some of the implicated drugs, you may want to exclude the signatures.

Note that while some COSMIC signatures are attributed sequencing artifacts, you shouldn't exclude these because cancereffectsizeR already handles these signatures specially.


To get a list of signatures to exclude based on cancer type and treatment status, you can use `suggest_cosmic_signatures_to_remove()`.
```{r eval = F}
  suggest_cosmic_signatures_to_remove(cancer_type = "BRCA", treatment_naive = TRUE)
  suggest_cosmic_signatures_to_remove(cancer_type = "Kidney-RCC")
```

The cancer type recommendations are based on Extended Data Figure 5 of Alexandrov 2020. The first two columns of the table below, also based on that figure, give the labels accepted by the `cancer_type` argument. (Note: SBS84 and SBS85 are absent from the Alexandrov figure, but they are elsewhere described in the paper as specific to lymphoid neoplasms.)

Before excluding signatures, make sure your data set does not contain tumors from multiple PCAWG categories. For example, TCGA HNSC (head and neck cancer) includes oral cancers, which are listed separately here as Oral-SCC, so excluding all signatures that do not appear in Head-SCC (such as SBS29, tobacco chewing) would not be appropriate.  

```{r, echo=FALSE, warning=FALSE, message=FALSE}
  data_source = paste0(system.file("extdata", package = "cancereffectsizeR"), '/COSMIC_v3_signatures_by_cancer_type.txt')
  cancer_type = data.table::fread(data_source)
  cancer_type[is.na(cancer_type)] = "(none)"
  formattable::formattable(cancer_type[, .(PCAWG, Applicable_TCGA, Number_of_tumors, Description)])
```


