<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started • cancereffectsizeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="cancereffectsizeR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cancereffectsizeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cancereffectsizeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cosmic_cancer_type_note.html">Cancer type considerations for COSMIC signature extraction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/blob/master/vignettes/cancereffectsizeR.Rmd"><code>vignettes/cancereffectsizeR.Rmd</code></a></small>
      <div class="hidden name"><code>cancereffectsizeR.Rmd</code></div>

    </div>

    
    
<p>Once you have installed cancereffectsizeR, you need a somatic mutation text file covering your samples in <a href="https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format">MAF format</a>. If you want to try out the software with publicly-available data, you can download MAFs covering collections of tumors from many cancer types from the TCGA data portal.</p>
<div id="maf-pre-processing" class="section level3">
<h3 class="hasAnchor">
<a href="#maf-pre-processing" class="anchor"></a>MAF pre-processing</h3>
<p>You want to be confident that the mutations in your MAF file are real. It’s hard to give detailed variant filtering advice because so much depends on the quality of the somatic variant calling pipeline used to produce the file. If your pipeline is excellent or your file has been curated by a group like TCGA, then perhaps no filtering is necessary. If you’re unsure, here are a few tips:</p>
<ul>
<li>There should be few to no mutations called at SNP sites, or at sites where population databases show frequent variation.</li>
<li>There should be few to no mutations in repetitive or poorly mapped regions of the genome, as mutations in these sites are difficult to call confidently and should be rare anyways since these regions are usually not functionally important.</li>
<li>If you have samples from different sources, check if there are recurrent mutations exclusive to each group. Or, if a large public data set is available, check if your samples have recurrent mutations absent from the public data. If a group has several mutations shared by multiple samples that don’t appear anywhere else–especially if they’re in unknown genes, absent from a large reference data set, and/or were all sequenced together–be suspicious of the data quality.</li>
</ul>
<p>Once you have a high-confidence set of variants, <strong>do not</strong> filter out records based on silent mutation status or other functional criteria. cancereffectsizeR needs the full set of high-confidence mutations from all samples. (Exception: As cancereffectsizeR currently only fully analyzes single-nucleotide variants, it’s fine to filter out indels.)</p>
</div>
<div id="create-cesanalysis" class="section level3">
<h3 class="hasAnchor">
<a href="#create-cesanalysis" class="anchor"></a>Create CESAnalysis</h3>
<p>Begin by declaring your CESAnalysis object, the primary data structure of cancereffectsizeR. If you have chronological tumor progression state information (e.g., stages 1-4, primary/metastatic, or pre-/post-treatment), then you can provide this information to the analysis in order to have baseline site mutation rates and selection intensities calculated per state rather than all together. You will also supply your genome build.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">  <span class="co"># skip progression_order for a single-state selection model</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/CESAnalysis.html">CESAnalysis</a></span>(<span class="kw">genome</span> <span class="kw">=</span> <span class="st">"hg19"</span>, <span class="kw">progression_order</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Primary"</span>, <span class="st">"Metastatic"</span>))</pre></body></html></div>
<p>Note: Currently only hg19 is supported, but detailed instructions are coming soon for generating custom reference data to run CES with any genome build.</p>
</div>
<div id="load-maf-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-maf-data" class="anchor"></a>Load MAF data</h3>
<p>Next, use <code><a href="../reference/load_maf.html">load_maf()</a></code> to load <a href="https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/#gdc-maf-format-v100">MAF</a> data from a text file or a data table into a CESAnalysis object. If column names don’t match MAF format specifications, you can supply your own column names. The only required columns are those specifying chromosome, position, reference and tumor alleles, and sample ID (Tumor_Sample_Barcode, by default); any other columns in your data will be ignored. If your CESAnalysis includes chronological tumor progression states (see Create CESAnalysis, above), also specify <code>progression_col</code>.</p>
<p>Most of the runtime of <code>load_maf</code> goes to producing tables of mutation annotations. These annotations are required for cancereffectsizeR functions and may also be useful for other analyses. Still, you can sometimes save time by setting <code>annotate = FALSE</code>. You’ll have to reload the data in a new CESAnalysis later, or you can run <code><a href="../reference/annotate_variants.html">annotate_variants()</a></code>.</p>
<div id="sequencing-data-coverage" class="section level4">
<h4 class="hasAnchor">
<a href="#sequencing-data-coverage" class="anchor"></a>Sequencing data coverage</h4>
<p>By default, data is assumed to be derived from whole-exome sequencing. Whole-genome data and targeted sequencing data are also supported when the <code>coverage</code> option is specified. For targeted sequencing data, you must provide the set of target regions as a BED file or GRanges object. You can also supply this information for exome data, if you have it available. See <code><a href="../reference/load_maf.html">load_maf()</a></code> for details.</p>
</div>
<div id="liftover-support" class="section level4">
<h4 class="hasAnchor">
<a href="#liftover-support" class="anchor"></a>LiftOver support</h4>
<p>If the MAF data you are loading is from a different genome build than your CESAnalysis, you can use the <code>chain_file</code> option to supply a UCSC-style chain file, and then your MAF coordinates will be automatically converted with liftOver.</p>
</div>
<div id="examples" class="section level4">
<h4 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h4>
<div class="sourceCode" id="cb2"><html><body><pre class="r">  <span class="co">## Example 1</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/CESAnalysis.html">CESAnalysis</a></span>(<span class="kw">genome</span> <span class="kw">=</span> <span class="st">"hg19"</span>)

  <span class="co"># load in some whole-exome MAF data</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/load_maf.html">load_maf</a></span>(<span class="no">analysis</span>, <span class="kw">maf</span> <span class="kw">=</span> <span class="st">"wes_lung_adenocarcinoma.maf"</span>)

  <span class="co"># add some whole-genome data (and lift from hg38 to hg19 with a user-provided chain file)</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/load_maf.html">load_maf</a></span>(<span class="no">analysis</span>, <span class="kw">maf</span> <span class="kw">=</span> <span class="st">"wgs_luad.maf"</span>, <span class="kw">coverage</span> <span class="kw">=</span> <span class="st">"genome"</span>, <span class="kw">chain_file</span> <span class="kw">=</span> <span class="st">"hg38ToHg19.over.chain"</span>)

  <span class="co"># add some targeted gene sequencing data</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/load_maf.html">load_maf</a></span>(<span class="no">analysis</span>, <span class="kw">maf</span> <span class="kw">=</span> <span class="st">"cancer-gene-targeted_luad.maf"</span>, <span class="kw">coverage</span> <span class="kw">=</span> <span class="st">"targeted"</span>,
                      <span class="kw">covered_regions</span> <span class="kw">=</span> <span class="st">"my_target_regions.bed"</span>, <span class="kw">covered_regions_name</span> <span class="kw">=</span> <span class="st">"TGS1"</span>)


  <span class="co">## Example 2</span>
  <span class="co"># Creating an analysis for data that has samples annotated as stage 1-4</span>
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/CESAnalysis.html">CESAnalysis</a></span>(<span class="kw">genome</span> <span class="kw">=</span> <span class="st">"hg19"</span>, <span class="kw">progression_order</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>))
  <span class="no">analysis</span> <span class="kw">=</span> <span class="fu"><a href="../reference/load_maf.html">load_maf</a></span>(<span class="no">analysis</span>, <span class="kw">maf</span> <span class="kw">=</span> <span class="st">"my_multistage.maf"</span>, <span class="kw">progression_col</span> <span class="kw">=</span> <span class="st">"stage"</span>)</pre></body></html></div>
</div>
</div>
<div id="calculate-mutation-rates-and-estimate-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-mutation-rates-and-estimate-selection" class="anchor"></a>Calculate mutation rates and estimate selection</h3>
<p>After loading in data, run the following functions to prepare for calculation of cancer effect size. See function reference for details.</p>
<ul>
<li>
<code><a href="../reference/trinuc_mutation_rates.html">trinuc_mutation_rates()</a></code> uses deconstructSigs to extract mutational signature weightings from each tumor’s SNV mutation profile, and from there calculates trinucleotide-context-specific SNV mutation rates. See also <code><a href="../articles/cosmic_cancer_type_note.html">vignette("cosmic_cancer_type_note")</a></code> for advice on excluding certain signatures that may be presumed absent from your tumors.</li>
<li>
<code><a href="../reference/gene_mutation_rates.html">gene_mutation_rates()</a></code> uses dNdScv to calculate gene-level mutation rates. It’s highly recommended to supply tissue-specific covariate data if available. Covariates for many human tissue types are included with this package. Default hg19 covariates from dNdScv are also available.</li>
</ul>
<p>Finally, use <code><a href="../reference/ces_snv.html">ces_snv()</a></code> to find calculate effect sizes.</p>
<pre><code>  # Create CESAnalysis object and define the chronological tumor progression states
  analysis = CESAnalysis(genome = "hg19", progression_order = c("Primary", "Metastatic"))
  analysis = load_maf(analysis, maf = "luad_data.maf", progression_col = "pri_met")
  
  # Before running trinuc_mutation_rates, which includes a mutational signature analysis,
  # you can run this function to identify possible signatures to exclude. It's recommended
  # to manually review the suggestions and decide which signatures to exclude. While this
  # step is likely to make signature extraction more accurate, it's probably safe to
  # skip this step if you're uncertain.
  #
  # Here, we decide to accept all suggestions, so we assign the output of the function
  # (a vector of signatures to exclude) to the to_remove variable.
  to_remove = suggest_cosmic_signatures_to_remove(cancer_type = "LUAD", treatment_naive = T)
  
  analysis = trinuc_mutation_rates(analysis, signature_set = "COSMIC_v3.1", signatures_to_remove = to_remove)
  analysis = gene_mutation_rates(analysis, covariates = "lung")
  
  
  # Calculate selection intensities
  analysis = ces_snv(analysis)</code></pre>
<div id="note-on-parallel-processing" class="section level4">
<h4 class="hasAnchor">
<a href="#note-on-parallel-processing" class="anchor"></a>Note on parallel processing</h4>
<p>If you are running in a MacOS or Linux environment, you can speed up processing by providing multiple computing cores using the “cores” argument. Run <code><a href="https://rdrr.io/r/parallel/detectCores.html">parallel::detectCores()</a></code> to find out how many cores you have available.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">  <span class="co"># assuming you've already loaded MAF data into object "cesa"</span>
  <span class="no">cesa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/trinuc_mutation_rates.html">trinuc_mutation_rates</a></span>(<span class="no">cesa</span>, <span class="kw">signature_set</span> <span class="kw">=</span> <span class="st">"COSMIC_v3.1"</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>)
  <span class="no">cesa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/gene_mutation_rates.html">gene_mutation_rates</a></span>(<span class="no">cesa</span>, <span class="kw">covariates</span> <span class="kw">=</span> <span class="st">"breast"</span>)
  <span class="no">cesa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/ces_snv.html">ces_snv</a></span>(<span class="no">cesa</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Vincent L. Cannataro, Jeff Mandell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
