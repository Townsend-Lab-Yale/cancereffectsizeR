<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate relative rates of trinucleotide-context-specific mutations by extracting underlying mutational processes — trinuc_mutation_rates • cancereffectsizeR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Calculate relative rates of trinucleotide-context-specific mutations by extracting underlying mutational processes — trinuc_mutation_rates" />
<meta property="og:description" content="This function calculates expected relative rates of trinucleotide-context-specific SNV
mutations within tumors by attributing SNVs to mutational processes represented in
mutation signature sets (such as &quot;COSMIC v3.2&quot;). Signature extraction can be done with
MutationalPatterns (default) or deconstructSigs. Tumors with targeted sequencing data
are assigned the average trinucleotide mutation rates calculated across all
exome/genome data, which means that you need at least some exome or genome data to run." />
<meta property="og:image" content="https://townsend-lab-yale.github.io/cancereffectsizeR/index.html/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cancereffectsizeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cancereffectsizeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cosmic_cancer_type_note.html">Cancer type considerations for COSMIC signature extraction</a>
    </li>
    <li>
      <a href="../articles/create_custom_covariates.html">Generate tissue covariates data</a>
    </li>
    <li>
      <a href="../articles/custom_refset_instructions.html">Running with custom reference data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate relative rates of trinucleotide-context-specific mutations by extracting underlying mutational processes</h1>
    <small class="dont-index">Source: <a href='https://github.com/Townsend-Lab-Yale/cancereffectsizeR/blob/main/R/trinuc_mutation_rates.R'><code>R/trinuc_mutation_rates.R</code></a></small>
    <div class="hidden name"><code>trinuc_mutation_rates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates expected relative rates of trinucleotide-context-specific SNV
mutations within tumors by attributing SNVs to mutational processes represented in
mutation signature sets (such as "COSMIC v3.2"). Signature extraction can be done with
MutationalPatterns (default) or deconstructSigs. Tumors with targeted sequencing data
are assigned the average trinucleotide mutation rates calculated across all
exome/genome data, which means that you need at least some exome or genome data to run.</p>
    </div>

    <pre class="usage"><span class='fu'>trinuc_mutation_rates</span><span class='op'>(</span>
  <span class='va'>cesa</span>,
  signature_set <span class='op'>=</span> <span class='cn'>NULL</span>,
  signatures_to_remove <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  sample_group <span class='op'>=</span> <span class='cn'>NULL</span>,
  cores <span class='op'>=</span> <span class='fl'>1</span>,
  signature_extractor <span class='op'>=</span> <span class='st'>"MutationalPatterns"</span>,
  mp_strict_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  assume_identical_mutational_processes <span class='op'>=</span> <span class='cn'>FALSE</span>,
  sig_averaging_threshold <span class='op'>=</span> <span class='fl'>50</span>,
  use_dS_exome2genome <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cesa</th>
      <td><p>CESAnalysis object</p></td>
    </tr>
    <tr>
      <th>signature_set</th>
      <td><p>name of built-in signature set (see <code><a href='list_ces_signature_sets.html'>list_ces_signature_sets()</a></code>), or a custom signature set (see details)</p></td>
    </tr>
    <tr>
      <th>signatures_to_remove</th>
      <td><p>specify any signatures to exclude from analysis; use <code><a href='suggest_cosmic_signatures_to_remove.html'>suggest_cosmic_signatures_to_remove()</a></code> for advice on COSMIC signatures</p></td>
    </tr>
    <tr>
      <th>sample_group</th>
      <td><p>vector of sample group(s) to calculate rates for (default all)</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>how many cores to use for processing tumors in parallel</p></td>
    </tr>
    <tr>
      <th>signature_extractor</th>
      <td><p>one of "MutationalPatterns" (default) or "deconstructSigs"</p></td>
    </tr>
    <tr>
      <th>mp_strict_args</th>
      <td><p>Named list of arguments to pass to MutationalPatterns'
fit_to_signatures_strict function. Note that mut_matrix and signatures arguments are
generated automatically, and that if you'd rather not use the strict method, you can
emulate fit_to_signatures() by setting max_delta = 0.</p></td>
    </tr>
    <tr>
      <th>assume_identical_mutational_processes</th>
      <td><p>use well-mutated tumors (those with number
of eligible mutations meeting sig_averaging_threshold) to calculate group average
signature weights, and assign these to all tumors</p></td>
    </tr>
    <tr>
      <th>sig_averaging_threshold</th>
      <td><p>Mutation prevalence threshold (default 50) that
determines which tumors inform the calculation of group-average signature weights.
When assume_identical_mutational_processes == FALSE (the default), these group
averages are blended into the signature weights of sub-threshold tumors.</p></td>
    </tr>
    <tr>
      <th>use_dS_exome2genome</th>
      <td><p>historical dev option (don't use)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>CESAnalysis with sample-specific signature weights and inferred
  trinucleotide-context-specific relative mutation rates. The snv_counts matrix gives
  the numbers of SNVs in each trinucleotide context in all samples in CESAnalysis. (As
  noted elsewhere, recurrent mutations are excluded to reduce the influence of
  selection.) This matrix, produced by `trinuc_snv_counts()`, can be fed directly into
  MutationalPatterns if you wish to run your own extended signature analysis.</p>  
<p>The raw_attributions table contains signature attributions as produced by
  MutationalPatterns or deconstructSigs. The biological_weights table has several
  differences:</p><ul>
<li><p>Weights for signatures associated with artifactual (as opposed to biological) processes are set to zero.</p></li>
<li><p>The remaining weights are normalized to sum to 1.</p></li>
<li><p>Tumors with few mutations (defined by `sig_averaging_threshold`, default = 50)
  have their weights redefined using a blend of their original weights and weights
  derived from running signature extraction en masse on tumors with above-threshold
  mutation counts. These samples are identifiable by filtering the table on
  `group_avg_blended == TRUE`, and we recommend excluding them from most downstream
  signature analysis. (These weights are useful as a best
  guess of mutational processes, but they shouldn't be reported in any way that
  implies their independence from the group-average weights.)</p>  
<p>Biological weights can be interpreted as follows: Out of all the mutations caused by
  biological processes represented in the signatures, the proportion of mutations
  attributed to given signature is its weight.</p>  
<p>Either signature attributions table can be converted into the matrix format used by MutationalPatterns 
  with `convert_signature_weights_for_mp()`.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To reduce the influence of selection on the estimation of relative trinucleotide mutation
rates, only non-recurrent SNVs (those that do not appear in more than one 
sample in the data set) are used.</p>
<p>A custom signature set should be given as a named three-item list, where "signatures"
is a pure data.frame with signature definitions, "name" is a 1-length character naming
the set, and "metadata" is a data.table with a "Signature" column that matches rownames
in the signature definitions. The following columns allow special functionality:</p><ul>
<li><p>Etiology: Known or hypothesized mutational processes underlying the signature. Used 
for human-readable tables and plots, so best to enter something like "Unknown" rather
than leaving any entries empty or NA</p></li>
<li><p>Likely_Artifact (logical T/F): Marks signatures that are believed to
derive from sample processing, sequencing, calling error, or other non-biological
sources. cancereffectsizeR adjusts for artifact signatures when inferring relative
trinucleotide mutation rates.</p></li>
<li><p>Exome_Min: Minimum number of mutations a WES sample
must have for the presence of the signature to be plausible. This information is used to
prevent hypermutation signatures from being found in tumors with few mutations. Can be
left NA or 0 for non-hypermutation signatures. If this column is present, Genome_Min
must be present and always greater than or equal to Exome_Min.</p></li>
<li><p>Genome_Min:
Minimum number of mutations a WGS sample must have for the presence of the signature to
be plausible. This information is used to prevent hypermutation signatures from being found
in tumors with few mutations. Can be left NA or 0 for non-hypermutation signatures. If
this column is present, Exome_Min must be present and always less than or equal to
Genome_Min.</p></li>
</ul><p>If you don't have any metadata available for your signature set, an empty data table
can also be supplied. For a template signature set object, run 
<code>sig_set = get_ces_signature_set("ces.refset.hg19", "COSMIC_v3.2")</code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Vincent L. Cannataro, Jeff Mandell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '85c732458d5af0ba2cd9feb9eb7f9a97',
    indexName: 'cancereffectsizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


