<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot pairwise epistasis — plot_epistasis • cancereffectsizeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot pairwise epistasis — plot_epistasis"><meta name="description" content="Visualize pairwise epistatic scaled selection coefficients, as calculated by
ces_epistasis() or ces_gene_epistasis(). For each variant, the isolated site
effect–the overall scaled selection at the site without regard for the mutation status of the
other site–is also depicted."><meta property="og:description" content="Visualize pairwise epistatic scaled selection coefficients, as calculated by
ces_epistasis() or ces_gene_epistasis(). For each variant, the isolated site
effect–the overall scaled selection at the site without regard for the mutation status of the
other site–is also depicted."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cancereffectsizeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cancereffectsizeR.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cosmic_cancer_type_note.html">Cancer type considerations for COSMIC signature extraction</a></li>
    <li><a class="dropdown-item" href="../articles/create_custom_covariates.html">Generate tissue covariates data</a></li>
    <li><a class="dropdown-item" href="../articles/custom_refset_instructions.html">Running with custom reference data</a></li>
    <li><a class="dropdown-item" href="../articles/MAF_filtering_tips.html">MAF filtering and sample validation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot pairwise epistasis</h1>
      <small class="dont-index">Source: <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/blob/main/R/plot_epistasis.R" class="external-link"><code>R/plot_epistasis.R</code></a></small>
      <div class="d-none name"><code>plot_epistasis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Visualize pairwise epistatic scaled selection coefficients, as calculated by
<code><a href="ces_epistasis.html">ces_epistasis()</a></code> or <code><a href="ces_gene_epistasis.html">ces_gene_epistasis()</a></code>. For each variant, the isolated site
effect–the overall scaled selection at the site without regard for the mutation status of the
other site–is also depicted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_epistasis</span><span class="op">(</span></span>
<span>  <span class="va">epistatic_effects</span>,</span>
<span>  pairs_per_row <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  x_title <span class="op">=</span> <span class="st">"Site pairs"</span>,</span>
<span>  variant_label_size <span class="op">=</span> <span class="fl">6.5</span>,</span>
<span>  dodge_labels <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  alternating_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#7cb4de"</span>, <span class="st">"#7DD3AF"</span><span class="op">)</span>,</span>
<span>  include_schematic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  schematic_label_size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  significance_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  significance_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_change <span class="op">=</span> <span class="st">"p_A_change"</span>, B_change <span class="op">=</span> <span class="st">"p_B_change"</span>, model <span class="op">=</span></span>
<span>    <span class="st">"p_epistasis"</span><span class="op">)</span>,</span>
<span>  inference_floor <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-epistatic-effects">epistatic_effects<a class="anchor" aria-label="anchor" href="#arg-epistatic-effects"></a></dt>
<dd><p>Epistatic effects inference table, as produced by <code><a href="ces_epistasis.html">ces_epistasis()</a></code>
or <code><a href="ces_gene_epistasis.html">ces_gene_epistasis()</a></code>.</p></dd>


<dt id="arg-pairs-per-row">pairs_per_row<a class="anchor" aria-label="anchor" href="#arg-pairs-per-row"></a></dt>
<dd><p>How many epistatic pairs to show in each plot row. The provided value is
incremented if need to prevent the legend schematic from being isolated on its own row.</p></dd>


<dt id="arg-x-title">x_title<a class="anchor" aria-label="anchor" href="#arg-x-title"></a></dt>
<dd><p>X-axis label. Set NULL for no label.</p></dd>


<dt id="arg-variant-label-size">variant_label_size<a class="anchor" aria-label="anchor" href="#arg-variant-label-size"></a></dt>
<dd><p>Text size for the variant labels.</p></dd>


<dt id="arg-dodge-labels">dodge_labels<a class="anchor" aria-label="anchor" href="#arg-dodge-labels"></a></dt>
<dd><p>TRUE/FALSE on using n.dodge (height staggering) on variant labels. Defaults
to "auto"; you can try setting manually if labels are not looking good.</p></dd>


<dt id="arg-alternating-colors">alternating_colors<a class="anchor" aria-label="anchor" href="#arg-alternating-colors"></a></dt>
<dd><p>Colors, provided as character vector, to use on epistatic effect
arrows. It's recommended to supply one or two colors, but more will work.</p></dd>


<dt id="arg-include-schematic">include_schematic<a class="anchor" aria-label="anchor" href="#arg-include-schematic"></a></dt>
<dd><p>TRUE/FALSE on whether to include the schematic that shows how to interpret the plot.
If you need to put the schematic somewhere special, set to FALSE and then get your own copy of it
with <code><a href="epistasis_plot_schematic.html">epistasis_plot_schematic()</a></code>.</p></dd>


<dt id="arg-schematic-label-size">schematic_label_size<a class="anchor" aria-label="anchor" href="#arg-schematic-label-size"></a></dt>
<dd><p>Text size of labels in the schematic.</p></dd>


<dt id="arg-significance-levels">significance_levels<a class="anchor" aria-label="anchor" href="#arg-significance-levels"></a></dt>
<dd><p>A vector of 1-3 distinct numeric values on (0, 1) in descending order
to use for significance annotations.</p></dd>


<dt id="arg-significance-cols">significance_cols<a class="anchor" aria-label="anchor" href="#arg-significance-cols"></a></dt>
<dd><p>A named list of column names that give significance values for nonzero
change in selection for each pair of sites A and B, and for the performance of the epistatic
selection model over a model that ignores epistatic interactions. List elements must be named
A_change (default "p_A_change") B_change ("p_B_change"), and model ("p_epistasis"). The purpose
of this option is to support the use of different columns when multiple testing correction is
performed.</p></dd>


<dt id="arg-inference-floor">inference_floor<a class="anchor" aria-label="anchor" href="#arg-inference-floor"></a></dt>
<dd><p>Numeric value of the optimization floor used in epistatic effect
inference. Typically, should be left at the default value, which matches cancereffectsizeR
epistatic inference defaults. For plot legibility, there will be a dashed horizontal line in
the output plot, higher than <code>inference_floor</code> and lower than any non-minimized parameter
inference, which indicates that all arrows pointing below the line have estimates at the
optimization floor.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Variant pairs for which the epistatic selection model is not significantly better than a
no-epistasis model (in which <code>ces_A0 = ces_A_on_B</code> and <code>ces_B0 = ces_B_on_A</code>) are depicted
with faded arrows; the threshold is <code>p_epistasis &lt; .05</code> (or, instead of p_epistasis,
whatever corrected significance column is specified with <code>significance_cols</code>).</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent L. Cannataro, Jeff Mandell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

