<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gene-level epistasis — ces_gene_epistasis • cancereffectsizeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Gene-level epistasis — ces_gene_epistasis"><meta name="description" content="Calculate selection intensity under an assumption of pairwise gene-level epistasis.
Selection at the gene level is assumed to act through all
specified variants (see options), with the selection for each gene's variants allowed
to vary based on the mutational status of the other gene's variants."><meta property="og:description" content="Calculate selection intensity under an assumption of pairwise gene-level epistasis.
Selection at the gene level is assumed to act through all
specified variants (see options), with the selection for each gene's variants allowed
to vary based on the mutational status of the other gene's variants."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cancereffectsizeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cancereffectsizeR.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cosmic_cancer_type_note.html">Cancer type considerations for COSMIC signature extraction</a></li>
    <li><a class="dropdown-item" href="../articles/create_custom_covariates.html">Generate tissue covariates data</a></li>
    <li><a class="dropdown-item" href="../articles/custom_refset_instructions.html">Running with custom reference data</a></li>
    <li><a class="dropdown-item" href="../articles/MAF_filtering_tips.html">MAF filtering and sample validation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gene-level epistasis</h1>
      <small class="dont-index">Source: <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/blob/main/R/epistasis_wrappers.R" class="external-link"><code>R/epistasis_wrappers.R</code></a></small>
      <div class="d-none name"><code>ces_gene_epistasis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate selection intensity under an assumption of pairwise gene-level epistasis.
Selection at the gene level is assumed to act through all
specified variants (see options), with the selection for each gene's variants allowed
to vary based on the mutational status of the other gene's variants.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ces_gene_epistasis</span><span class="op">(</span></span>
<span>  cesa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variants <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  run_name <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  lik_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimizer_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pval_calc_fn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_fit <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cesa">cesa<a class="anchor" aria-label="anchor" href="#arg-cesa"></a></dt>
<dd><p>CESAnalysis object</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Vector of gene names; SIs will be calculated for all gene pairs. Alternatively,
a list of gene pairs (2-length character vectors) to run just the given pairings.</p></dd>


<dt id="arg-variants">variants<a class="anchor" aria-label="anchor" href="#arg-variants"></a></dt>
<dd><p>Which variants to include in inference for each gene. Either "recurrent" for all
variants present in two or more samples (across all MAF data), "nonsilent" for nonsynonymous
coding variants and variants in essential splice sites, or a data.table containing all variants
to include (as returned by <code><a href="select_variants.html">select_variants()</a></code> or by
subsetting<code>[CESAnalysis\]$variants</code>). For noncoding variants with multiple gene
annotations, the one listed in the "gene" column is used. In the recurrent method, nearby
noncoding variants may be included.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Which samples to include in inference. Can be a vector of
Unique_Patient_Identifiers, or a data.table containing rows from the CESAnalysis sample table.
Samples that do not have coverage at all variant sites in a given inference will be set aside.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Set to "default"  to use built-in
model of epistatic selection, or supply a custom function factory (see details).</p></dd>


<dt id="arg-run-name">run_name<a class="anchor" aria-label="anchor" href="#arg-run-name"></a></dt>
<dd><p>Optionally, a name to identify the current run.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Number of cores for parallel processing of gene pairs.</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>Confidence interval size from 0 to 1 (.95 -&gt; 95%). NULL skips calculation,
which may be helpful to reduce runtime when analyzing many gene pairs.</p></dd>


<dt id="arg-lik-args">lik_args<a class="anchor" aria-label="anchor" href="#arg-lik-args"></a></dt>
<dd><p>Extra arguments, given as a list, to pass to custom likelihood functions.</p></dd>


<dt id="arg-optimizer-args">optimizer_args<a class="anchor" aria-label="anchor" href="#arg-optimizer-args"></a></dt>
<dd><p>optimizer_args List of arguments to pass to the optimizer (bbmle::mle2).</p></dd>


<dt id="arg-pval-calc-fn">pval_calc_fn<a class="anchor" aria-label="anchor" href="#arg-pval-calc-fn"></a></dt>
<dd><p>For use with custom models; optional. A function that takes an epistasis
model fit as input and returns p-values and other descriptives.</p></dd>


<dt id="arg-return-fit">return_fit<a class="anchor" aria-label="anchor" href="#arg-return-fit"></a></dt>
<dd><p>TRUE/FALSE (default FALSE): Embed epistatic model fits for each gene pair in a "fit" attribute
of the epistasis results table. Use <code>attr(my_results, 'fit')</code> to access the list of fitted models.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>CESAnalysis with a table of epistatic inferences appended to list <code>[CESAnalysis]$epistasis</code>. Some column definitions:</p><ul><li><p>variant_A, variant_B: Gene names. Specifically, A and B refer to the merged sets of included variants from each gene.</p></li>
<li><p>ces_A0: Cancer effect (scaled selection coefficient) of variant A that acts in the absence of variant B.</p></li>
<li><p>ces_B0: Cancer effect of variant B that acts in the absence of variant A.</p></li>
<li><p>ces_A_on_B: Cancer effect of variant A that acts when a sample already has variant B.</p></li>
<li><p>ces_B_on_A: Cancer effect of variant B that acts when a sample already has variant A.</p></li>
<li><p>p_A_change: P-value of likelihood ratio test (LRT) that informs whether selection for
   variant A significantly changes after acquiring variant B. The LRT compares the likelihood of
   the full epistatic model to that of a reduced model in which ces_A0 and ces_A_on_B are set
   equal. The p-value is the probability, under the reduced model, of the likelihood ratio being
   greater than or equal to the ratio observed.</p></li>
<li><p>p_B_change:  P-value of likelihood ratio test (LRT) that informs whether selection for
   variant B significantly changes after acquiring variant A. The LRT compares the likelihood of
   the full epistatic model to that of a reduced model in which ces_B0 and ces_B_on_A are set
   equal. The p-value is the probability, under the reduced model, of the likelihood ratio being
   greater than or equal to the ratio observed.</p></li>
<li><p>p_epistasis: P-value of likelihood ratio test that informs whether the epistatic model
  better explains the mutation data than a non-epistatic model in which selection for mutations
  in each gene are independent of the mutation status in the other gene. Quite often, p_epistasis
  will suggest a significant epistatic effect even though p_A_change and p_B_change do not
  suggest significant changes in selection for either gene individually. This is because the
  degree of co-occurrence can often be explained equally well by a strong change in selection for
  either gene.</p></li>
<li><p>expected_nAB_epistasis: The expected number of samples with both A and B mutated under the fitted epistatic model.
  Typically, this will be very close to the actual number of AB samples (nAB).</p></li>
<li><p>expected_nAB_null: The expected number of samples with both A and B mutated under a no-epistasis model.</p></li>
<li><p>AB_epistatic_ratio: The ratio <code>expected_nAB_epistasis/expected_nAB_null</code>. Useful to gauge the overall
  impact of epistatic interactions on the co-occurrence of variants A and B. Since the expectations take mutation rates into account,
  this ratio is a better indicator than the relative frequencies of A0, B0, AB, 00 in the data set.</p></li>
<li><p>nA0, nB0, nAB, n00: Number of (included) samples with mutations in just A, just B, both A and B, and neither.</p></li>
<li><p>ces_A_null, ces_B_null: Cancer effects of A and B when estimated independently; that is,
  effects under a no-epistasis model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Only samples that have coverage at all included sites in both genes can be included in the
inference since samples lacking full coverage may or may not have mutations at the
uncovered sites.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent L. Cannataro, Jeff Mandell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

