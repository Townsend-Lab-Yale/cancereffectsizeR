<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Select and filter variants — select_variants • cancereffectsizeR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Select and filter variants — select_variants" />
<meta property="og:description" content="This function helps you find and view variant data from your CESAnalysis's MAF data and
mutation annotation tables. By default, almost all amino-acid-change mutations and
noncoding SNVs are returned. You can apply a series of filters to restrict output to
certain genes or genomic regions or require a minimum variant frequency in MAF data.
You can also specify some variants to include in output regardless of filters with
variant_passlist. Special behavior: If variant_passlist is used by
itself, then only those specified variants will be returned." />
<meta property="og:image" content="https://townsend-lab-yale.github.io/cancereffectsizeR/index.html/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cancereffectsizeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cancereffectsizeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cosmic_cancer_type_note.html">Cancer type considerations for COSMIC signature extraction</a>
    </li>
    <li>
      <a href="../articles/create_custom_covariates.html">Generate tissue covariates data</a>
    </li>
    <li>
      <a href="../articles/custom_refset_instructions.html">Running with custom reference data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Townsend-Lab-Yale/cancereffectsizeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select and filter variants</h1>
    <small class="dont-index">Source: <a href='https://github.com/Townsend-Lab-Yale/cancereffectsizeR/blob/master/R/variant_handling.R'><code>R/variant_handling.R</code></a></small>
    <div class="hidden name"><code>select_variants.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function helps you find and view variant data from your CESAnalysis's MAF data and
mutation annotation tables. By default, almost all amino-acid-change mutations and
noncoding SNVs are returned. You can apply a series of filters to restrict output to
certain genes or genomic regions or require a minimum variant frequency in MAF data.
You can also specify some variants to include in output regardless of filters with
<code>variant_passlist</code>. Special behavior: If <code>variant_passlist</code> is used by
itself, then only those specified variants will be returned.</p>
    </div>

    <pre class="usage"><span class='fu'>select_variants</span><span class='op'>(</span>
  <span class='va'>cesa</span>,
  genes <span class='op'>=</span> <span class='cn'>NULL</span>,
  min_freq <span class='op'>=</span> <span class='fl'>0</span>,
  variant_passlist <span class='op'>=</span> <span class='cn'>NULL</span>,
  gr <span class='op'>=</span> <span class='cn'>NULL</span>,
  variant_position_table <span class='op'>=</span> <span class='cn'>NULL</span>,
  include_subvariants <span class='op'>=</span> <span class='cn'>F</span>,
  padding <span class='op'>=</span> <span class='fl'>0</span>,
  collapse_lists <span class='op'>=</span> <span class='cn'>F</span>,
  remove_secondary_aac <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cesa</th>
      <td><p>CESAnalysis with MAF data loaded and annotated (e.g., with <code><a href='load_maf.html'>load_maf()</a></code>)</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>Filter variants to specified genes.</p></td>
    </tr>
    <tr>
      <th>min_freq</th>
      <td><p>Filter out variants with MAF frequency below threshold (default 0).
Note that variants that are not in the annotation tables will never be returned. Use
<code><a href='add_variants.html'>add_variants()</a></code> to include variants absent from MAF data in your CESAnalysis.</p></td>
    </tr>
    <tr>
      <th>variant_passlist</th>
      <td><p>Vector of variant IDs to include in output regardless of
filtering options. You can use CES-style AAC and SNV IDs or variant names like 
"KRAS G12C". If this argument is used by itself (without any filtering arguments),
then only these specified variants will be returned.</p></td>
    </tr>
    <tr>
      <th>gr</th>
      <td><p>Filter out any variants not within input GRanges +/- <code>padding</code> bases.</p></td>
    </tr>
    <tr>
      <th>variant_position_table</th>
      <td><p>Filter out any variants that don't intersect the
positions given in chr/start/end of this table (1-based closed coordinates).
Typically, the table comes from a previous <code>select_variants</code> call and can be expanded
with <code>padding</code>. (Gritty detail: Amino acid change SNVS get special handling. Only the
precise positions in start, end, and center_nt_pos are used. This avoids intersecting
extra variants between start/end, which on splice-site-spanning variants can be many
thousands.)</p></td>
    </tr>
    <tr>
      <th>include_subvariants</th>
      <td><p>Some mutations "contain" other mutations. For example, in
cancereffectsizeR's ces.refset.hg19, KRAS_Q61H contains two constituent
SNVs that both cause the same amino acid change: 12:25380275_T&gt;G and 12:25380275_T&gt;A.
When include_subvariants = F (the default), and genes = "KRAS", output will be
returned for KRAS_Q61H but not for the two SNVs (although their IDs will appear in
the Q61H output). Set to true, and all three variants will be included in output, 
assuming they don't get filtered out by other other options, like min_freq. If you
set this to TRUE, you can't directly plug the output table into selection functions.
However, you can pick a non-overlapping set of variant IDs from the output table 
and re-run <code>select_variants()</code> to put those variants into a new table for
selection functions.</p></td>
    </tr>
    <tr>
      <th>padding</th>
      <td><p>add +/- this many bases to every range specified in <code>gr</code> or
<code>variant_position_table</code> (stopping at chromosome ends, naturally).</p></td>
    </tr>
    <tr>
      <th>collapse_lists</th>
      <td><p>Some output columns may have multiple elements per variant row.
For example, all_genes may include multiple genes. These variable-length vectors
allow advanced filtering and manipulation, but the syntax can be tricky. Optionally,
set collapse_lists = T to convert these columns to comma-delimited strings, which are
sometimes easier to work with.</p></td>
    </tr>
    <tr>
      <th>remove_secondary_aac</th>
      <td><p>Default TRUE, except overridden (effectively FALSE) when
include_subvariants = T. Occasionally, due to overlapping coding sequence definitions
in reference data, a site can have more than one amino-acid-change mutation
annotation. To avoid returning the same genome-positional variants multiple times,
the default is to return one AAC in these situations. Tiebreakers are MAF frequency,
essential splice site status, non-silent status, gene mutation frequency,
alphabetical. The omitted AACs will still be included in the all_aac column, and if
any constituent SNVS of the AACs don't overlap, the non-overlapping SNVs from the
excluded AACs will still be included in output. If you set remove_secondary_aac to
FALSE, you can't put the output variant table in selection calculation functions. An
alternative is to set to FALSE, pick which (non-overlapping) variants you want, and
then re-run select_variants() with those variants specified in <code>variant_passlist</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data table with info on selected variants (see details), or a list of IDs.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Only variants that are present in the CESAnalysis's annotation tables can be returned,
which by default are those present in the MAF data. To select variants absent from MAF
data, you must first call add_variants() to add them to the CESAnalysis. Note that
while intergenic SNVs have their nearest genes annotated in the SNV tables, these
variants will not be captured by gene-based selection with this function, since they're
not actually in any gene.</p>
<p>Definitions of some less self-explanatory columns:</p><ul>
<li><p>variant_name: short, often but not necessarily uniquely identifying name (use
  variant_id to guarantee uniqueness)</p></li>
<li><p>start/end: lowest/highest genomic positions overlapping variant</p></li>
<li><p>variant_id: unique IDs for variants given the associated genome assembly version and the transcript data</p></li>
<li><p>ref/alt: genomic reference and alternate alleles (for genomic
  variants; NA for AACs)</p></li>
<li><p>gene: the affected gene in AACs; for SNVs, the
  overlapping gene (or an arbitrary gene if more than one overlaps), or the nearest gene
  for intergenic SNVs</p></li>
<li><p>strand: for AACs, 1 if the reference sequence strand is the coding strand; -1 otherwise</p></li>
<li><p>essential_splice: Variant is 1,2 bp upstream or
  1,2,5 bp downstream of an annotated splice position (edge case: if an SNV has
  multiple gene/transcript annotations, this doesn't say which one it's essential for)</p></li>
<li><p>intergenic: variant does not overlap any gene ranges in the reference data</p></li>
<li><p>trinuc_mut: for SNVs, the reference trinucleotide context, in deconstructSigs notation</p></li>
<li><p>coding_seq: coding strand nucleotides in order of transcription</p></li>
<li><p>center_nt_pos: regardless of strand, start/end give positions of two out of three AAC nucleotides; this
                      gives the position of the center nucleotide (maybe useful if the AAC spans a splice site)</p></li>
<li><p>constituent_snvs: all SNVs that can produce a given variant</p></li>
<li><p>multi_anno_site: T/F whether variant has multiple gene/transcript/AAC annotations</p></li>
<li><p>all_aac: For SNVs, all AACs that the variant is annotated as producing; for
  AACs, all of the AACs that are annotated for all of the constituent SNVs</p></li>
<li><p>all_genes: all genes overlapping the variant in reference data</p></li>
<li><p>covered_in: the names of all "covered regions" sets in the CESAnalysis that have coverage at the variant site</p></li>
<li><p>maf_freq: number of occurrences of the variant in MAF data</p></li>
</ul>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Vincent L. Cannataro, Jeff Mandell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '85c732458d5af0ba2cd9feb9eb7f9a97',
    indexName: 'cancereffectsizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


